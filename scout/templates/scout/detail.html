{% extends is_hybrid|yesno:"hybridize/base.html,scout/app.html" %}
{% load staticfiles %}

{% block title %}Details{% endblock %}

{% block web_content %}

{% if spot.has_alert %}
<p>ALERT<br/> {{ spot.alert_notes }}</p>
{% endif %}

<div style="background:url('{% static "scout/img/coffee-shop-1200.jpg" %}') no-repeat center center; background-size:cover; height:300px;">&nbsp;</div>

<div style="padding:20px;">

    <h2>{{spot.name}}</h2>

    <div style="text-align:right;">{% if spot.is_open %}<span style="color:green;">OPEN NOW</span>{% else %}<span style="color:#ddd;">CLOSED</span>{% endif %}</strong></div>



    <p>Type: {% for type in spot.spot_types %} {{ type.name }} {% endfor %}
    </p>

    <p>Open for:</p>
    <ul>
        {% for period in spot.open_periods %}
        <li>{{ period }}</li>
        {% endfor %}
    </ul>

    <p>Building description: {% if spot.building_description %}{{spot.building_description}}{% else %} <span style="color:red;">xxxxx xxx xx xxxxxxxxx xxx</span> {% endif %}</p>

    <p>Phone: {% if spot.phone %}{{ spot.phone }}{% else %} <span style="color:red;">xxxxx</span> {% endif %}</p>

    <p>Cuisine:</p>
    <ul>
        {% if cuisinetype %}
            {% for cuisinetype in spot.cuisinetype_names %}
            <li>{{ cuisinetype }}</li>
            {% endfor %}
        {% else %} <span style="color:red;">xxxxx</span> {% endif %}
    </ul>

    <p>Food served:</p>
    <ul>
        {% if foodtype %}
            {% for foodtype in spot.foodtype_names %}
                <li>{{ foodtype }}</li>
            {% endfor %}
        {% else %} <span style="color:red;">xxxxx</span> {% endif %}
    </ul>

    {% if spot.has_reservation %}
    <p>Reservations:
        <br/> {{spot.reservation_notes}}
    </p>

    {% endif %}

    <p>Payment accepted:</p>
    <ul>
        {% for payment in spot.payment_names %}
        <li>{{ payment }}</li>
        {% endfor %}
    </ul>

    <p style="overflow:hidden; text-overflow:ellipsis;">Menu URL: {% if spot.menu_url %}{{spot.menu_url}}{% else %} <span style="color:red;">xxxxx</span> {% endif %}</p>

    <h4>Hours</h4>
        <ul>
            <li>Monday: {% for hours in spot.hours.monday %} {{ hours.0 }} - {{ hours.1 }} {% empty %} Closed {% endfor %}</li>
            <li>Tuesday: {% for hours in spot.hours.tuesday %} {{ hours.0 }} - {{ hours.1 }} {% empty %} Closed {% endfor %}</li>
            <li>Wednesday: {% for hours in spot.hours.wednesday %} {{ hours.0 }} - {{ hours.1 }} {% empty %} Closed {% endfor %}</li>
            <li>Thursday: {% for hours in spot.hours.thursday %} {{ hours.0 }} - {{ hours.1 }} {% empty %} Closed {% endfor %}</li>
            <li>Friday: {% for hours in spot.hours.friday %} {{ hours.0 }} - {{ hours.1 }} {% empty %} Closed {% endfor %}</li>
            <li>Saturday: {% for hours in spot.hours.saturday %} {{ hours.0 }} - {{ hours.1 }} {% empty %} Closed {% endfor %}</li>
            <li>Sunday: {% for hours in spot.hours.sunday %} {{ hours.0 }} - {{ hours.1 }} {% empty %} Closed {% endfor %}</li>
        </ul>

    {% if spot.hours_notes %}
    <p>Hours Notes:</p>
    <ul>
        <li>{{spot.hours_notes}}</li>
    </ul>
    {% endif %}

    {% if request.is_mobile %}
    <div style="height:200px;">
        <div id="detail_map" style="height:100%;"></div>
    </div>

    <!-- since turbolinks loads the full body... initialize map stuff locally in the template. then, call the function in the map.js file -->
    <script>
        function initializeDetailMap() {

            var mapExists = document.getElementById("detail_map");
            var myLatlng, mapOptions;

            if (mapExists) {

                // center map direction on spot location
                myLatlng = new google.maps.LatLng({{ spot.latitude }}, {{ spot.longitude }});
                mapOptions = {
                    center: myLatlng,
                    zoom: 17,
                    scrollwheel: false,
                    draggable: false,
                    disableDefaultUI: true
                };

                var styles = [
                    {
                        "featureType": "poi.place_of_worship",
                        "elementType": "all",
                        "stylers": [
                            {
                                "visibility": "off"
                            }
                        ]
                    },
                    {
                        "featureType": "poi.business",
                        "elementType": "labels.icon",
                        "stylers": [
                            {
                                "visibility": "off"
                            }
                        ]
                    }
                ]

                var map = new google.maps.Map(document.getElementById('detail_map'), mapOptions);
                map.setOptions({styles: styles});

                var marker = new MarkerWithLabel({
                    position: myLatlng,
                    map: map,
                    title: '{{ spot.name }}!',
                    animation: google.maps.Animation.DROP,
                    labelContent: "<i class='fa fa-cutlery'></i><span class='marker-text' style='margin-left:15px;font-size:12px;'>{{ spot.name }}</span>",
                    labelAnchor: new google.maps.Point(6, 6),
                    labelClass: "map-label", // the CSS class for the label
                    icon: {
                		path: google.maps.SymbolPath.CIRCLE,
                		fillColor: '#53518e',
                		fillOpacity: 1,
                		strokeColor: '#6562aa',
                        strokeWeight: 5,
                        scale: 13,
                	},
                });
            }

        }
    </script>
    <p><a href="/">OPEN IN GOOGLE MAPS</a></p>
    {% endif %}

    <h4>Location information</h4>
    <ul>
        <li>Latitude: {{ spot.latitude }}</li>
        <li>Longitude: {{ spot.longitude }}</li>
        <li>Building: {% if spot.building_name %}{{ spot.building_name }}{% else %} <span style="color:red;">xxxxx</span> {% endif %}</li>
        <li>Floor: {% if spot.floor %}{{ spot.floor }}{% else %} <span style="color:red;">xxxxx</span> {% endif %}</li>
        <li>Room: {% if spot.room_number %}{{ spot.room_number }}{% else %} <span style="color:red;">xxxxx</span> {% endif %}</li>
    </ul>

    {% if spot.access_notes %}
    <p>Access Notes</p>
    <ul>
        <li>{{spot.access_notes}}</li>
    </ul>
    {% endif %}

    <h4>Misc. information</h4>
    <ul>
        <li>Has coupon: {% if spot.has_coupon %} {{ spot.has_coupon }}{% else %}false{% endif %}</li>
        <li>Coupon expire: {% if spot.coupon_expiration %}{{ spot.coupon_expiration }}{% endif %}</li>
        <li>Coupon URL: {% if spot.coupon_url %}{{ spot.coupon_url }}{% endif %}</li>
        <li style="overflow:hidden; text-overflow:ellipsis;">{% if spot.website_url %}Website URL: {{ spot.website_url }}{% endif %}</li>
    </ul>

    <h4>Owner</h4>
    <ul>
        <li>Organization: {% if spot.organization %}{{ spot.organization }}{% else %} <span style="color:red;">xxxxx</span> {% endif %}</li>
        <li>Manager: {% if spot.manager %}{{ spot.manager }}{% else %} <span style="color:red;">xxxxx</span> {% endif %}</li>
    </ul>

</div>
{% endblock %}

{% block sidebar %}
<!-- show a map on the list page -->
<div id="detail_map" style="height:100%;"></div>

<!-- since turbolinks loads the full body... initialize map stuff locally in the template. then, call the function in the map.js file -->
<script>
    function initializeDetailMap() {

        var mapExists = document.getElementById("detail_map");
        var myLatlng, mapOptions;

        if (mapExists) {

            // center map direction on spot location
            myLatlng = new google.maps.LatLng({{ spot.latitude }}, {{ spot.longitude }});
            mapOptions = {
                center: myLatlng,
                zoom: 20,
            };

            var styles = [
                {
                    "featureType": "poi.place_of_worship",
                    "elementType": "all",
                    "stylers": [
                        {
                            "visibility": "off"
                        }
                    ]
                },
                {
                "featureType": "poi.business",
                "elementType": "labels",
                "stylers": [
                    {
                        "visibility": "off"
                    }
                ]
            }
            ]

            var map = new google.maps.Map(document.getElementById('detail_map'), mapOptions);
            map.setOptions({styles: styles});

            var marker = new MarkerWithLabel({
                position: myLatlng,
                map: map,
                title: '{{ spot.name }}',
                //animation: google.maps.Animation.DROP,
                labelContent: "<i class='fa fa-cutlery'></i><span class='marker-text' style='margin-left:15px;font-size:12px;'>{{ spot.name }}</span>",
                labelAnchor: new google.maps.Point(6, 6),
                labelClass: "map-label", // the CSS class for the label
                icon: {
            		path: google.maps.SymbolPath.CIRCLE,
            		fillColor: '#53518e',
            		fillOpacity: 1,
            		strokeColor: '#6562aa',
                    strokeWeight: 5,
                    scale: 13,
            	},
            });
        }

    }
</script>

{% endblock %}

{% block hybrid_content %}

<div class="card">
    <div style="background:url('{% static "scout/img/placeholder.png" %}') no-repeat; background-size:cover; height:200px;" valign="bottom" class="card-header">{{spot.name}}</div>
    <div class="card-content">
        <div class="card-content-inner">

            {% if spot.has_alert %}
            <p>
                ALERT
                <br/> {{ spot.alert_notes }}
            </p>
            {% endif %}

            <p>type: {% for type in spot.spot_types %}
                {{ type.name }}
               {% endfor %}
            </p>

            <p>{{spot.building_description}}</p>

            <h4>Hours</h4>

            <ul>
                <li>Monday: {% for hours in spot.hours.monday %} {{ hours.0 }} - {{ hours.1 }} {% empty %} Closed {% endfor %}</li>
                <li>Tuesday: {% for hours in spot.hours.tuesday %} {{ hours.0 }} - {{ hours.1 }} {% empty %} Closed {% endfor %}</li>
                <li>Wednesday: {% for hours in spot.hours.wednesday %} {{ hours.0 }} - {{ hours.1 }} {% empty %} Closed {% endfor %}</li>
                <li>Thursday: {% for hours in spot.hours.thursday %} {{ hours.0 }} - {{ hours.1 }} {% empty %} Closed {% endfor %}</li>
                <li>Friday: {% for hours in spot.hours.friday %} {{ hours.0 }} - {{ hours.1 }} {% empty %} Closed {% endfor %}</li>
                <li>Saturday: {% for hours in spot.hours.saturday %} {{ hours.0 }} - {{ hours.1 }} {% empty %} Closed {% endfor %}</li>
                <li>Sunday: {% for hours in spot.hours.sunday %} {{ hours.0 }} - {{ hours.1 }} {% empty %} Closed {% endfor %}</li>
            </ul>

            {% if spot.hours_notes %}
            <p>Hours Notes:</p>
            <ul>
                <li>{{spot.hours_notes}}</li>
            </ul>
            {% endif %}


            <h4>Location information</h4>
            <ul>
                <li>{{ spot.latitude }}</li>
                <li>{{ spot.longitude }}</li>
                <li>{{ spot.building_name }}</li>
                <li>{{ spot.floor }}</li>
                <li>{{ spot.room_number }}</li>
                <li>{{ spot.capacity }}</li>
            </ul>
            {% if spot.access_notes %}
            <p>Access Notes</p>
            <ul>
                <li>{{spot.access_notes}}</li>
            </ul>
            {% endif %}
            <h4>Misc. information</h4>
            <ul>
                {% if spot.has_coupon %} <li>{{ spot.has_coupon }}</li>{% endif %}
                {% if spot.coupon_expiration %} <li>{{ spot.coupon_expiration }}</li>{% endif %}
                {% if spot.coupon_url %} <li>{{ spot.coupon_url }}</li>{% endif %}
                {% if spot.website_url %} <li>{{ spot.website_url }}</li>{% endif %}
            </ul>

            <h4>Management</h4>
            <p>this location is managed by...</p>
            <ul>
                <li>{{ spot.organization }}</li>
                <li>{{ spot.manager }}</li>
            </ul>

        </div>
    </div>
</div>

<div class="content-block-title">Open for:</div>
<div class="list-block">
    <ul>
        {% for period in spot.open_periods %}
        <li class="item-content">
            <div class="item-inner">
                <div class="item-title">{{ period }}</div>
            </div>
        </li>
        {% endfor %}
    </ul>
</div>

<div class="content-block-title">Cuisine:</div>
<div class="list-block">
    <ul>
        {% for cuisinetype in spot.cuisinetype_names %}
        <li class="item-content">
            <div class="item-inner">
                <div class="item-title">{{ cuisinetype }}</div>
            </div>
        </li>
        {% endfor %}
    </ul>
</div>

<div class="content-block-title">Food Served:</div>
<div class="list-block">
    <ul>
        {% for foodtype in spot.foodtype_names %}
        <li class="item-content">
            <div class="item-inner">
                <div class="item-title">{{ foodtype }}</div>
            </div>
        </li>
        {% endfor %}
    </ul>
</div>

<div class="content-block-title">Payment Accepted:</div>
<div class="list-block">
    <ul>
        {% for payment in spot.payment_names %}
        <li class="item-content">
            <div class="item-inner">
                <div class="item-title">{{ payment }}</div>
            </div>
        </li>
        {% endfor %}
    </ul>
</div>

<div class="content-block-title">Getting Here</div>
<div class="list-block">
    <ul>
        <li>
            <a href="maps://maps.apple.com/maps?q={{ spot.latitude }},{{ spot.longitude }}" class="item-link">
                <div class="item-content">
                    <div class="item-inner">
                        <div class="item-title">Open in Google Maps</div>
                    </div>
                </div>
            </a>
        </li>
    </ul>
</div>

{% endblock %}
